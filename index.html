<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UK 30-Year Gilt Yield &mdash; Fairhurst Buckley</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Century Gothic', CenturyGothic, Nunito, sans-serif;
            background: #ffffff;
            color: #32373c;
            min-height: 100vh;
        }

        /* ── Header ── */
        .header {
            background: #ffffff;
            border-bottom: 3px solid #7ebc3b;
            padding: 20px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-title h1 {
            font-size: 22px;
            font-weight: 700;
            color: #32373c;
        }

        .header-title p {
            font-size: 13px;
            color: #6b7280;
            margin-top: 2px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .header-meta {
            text-align: right;
            font-size: 12px;
            color: #6b7280;
        }

        .header-logo img {
            height: 48px;
            width: auto;
        }

        /* ── Yield Hero ── */
        .yield-hero {
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            padding: 32px 40px;
            display: flex;
            align-items: flex-end;
            gap: 32px;
            flex-wrap: wrap;
        }

        .yield-current {
            display: flex;
            align-items: baseline;
            gap: 8px;
            flex-wrap: wrap;
        }

        .yield-value {
            font-size: 56px;
            font-weight: 700;
            color: #32373c;
            letter-spacing: -2px;
            line-height: 1;
        }

        .yield-unit {
            font-size: 24px;
            color: #6b7280;
            font-weight: 400;
        }

        .yield-time {
            width: 100%;
            font-size: 12px;
            color: #9ca3af;
            font-weight: 400;
            letter-spacing: 0;
            margin-top: 2px;
        }

        .yield-change {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding-bottom: 6px;
        }

        .change-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 13px;
            font-weight: 700;
        }

        .change-badge.positive {
            background: rgba(126, 188, 59, 0.12);
            color: #5a9a1f;
        }

        .change-badge.negative {
            background: rgba(220, 38, 38, 0.08);
            color: #dc2626;
        }

        .change-label {
            font-size: 11px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ── Summary Callout ── */
        .summary-callout {
            background: #f0f9eb;
            border-bottom: 1px solid #c8e6a5;
            padding: 16px 40px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            color: #32373c;
            line-height: 1.5;
        }

        .summary-callout .sc-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .summary-callout strong {
            color: #32373c;
        }

        .summary-callout .sc-highlight {
            font-weight: 700;
            color: #7ebc3b;
        }

        /* ── Container ── */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 28px 40px;
        }

        /* ── Stat Cards ── */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 28px;
        }

        .stat-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            transition: box-shadow 0.2s;
        }

        .stat-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .stat-label {
            font-size: 11px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #32373c;
        }

        .stat-sub {
            font-size: 12px;
            color: #9ca3af;
            margin-top: 4px;
        }

        .stat-value.positive { color: #5a9a1f; }
        .stat-value.negative { color: #dc2626; }

        /* ── Chart ── */
        .chart-container {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 24px;
            margin-bottom: 28px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .timeframe-btns {
            display: flex;
            gap: 6px;
        }

        .tf-btn {
            padding: 5px 14px;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            background: #fff;
            color: #6b7280;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.15s;
        }

        .tf-btn:hover {
            border-color: #7ebc3b;
            color: #7ebc3b;
        }

        .tf-btn.active {
            background: #7ebc3b;
            color: #fff;
            border-color: #7ebc3b;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 700;
            color: #32373c;
        }

        .chart-subtitle {
            font-size: 13px;
            color: #6b7280;
        }

        .chart-wrapper {
            position: relative;
            height: 450px;
        }

        /* ── Trend Summary ── */
        .trend-summary {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 16px 22px;
            margin-bottom: 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            color: #32373c;
            line-height: 1.5;
        }

        .trend-summary .trend-icon {
            font-size: 22px;
            flex-shrink: 0;
        }

        .trend-summary .trend-direction {
            font-weight: 700;
        }

        .trend-summary .trend-favourable {
            color: #5a9a1f;
        }

        .trend-summary .trend-adverse {
            color: #dc2626;
        }

        .trend-summary .trend-bps {
            font-weight: 700;
            color: #6b7280;
        }

        /* ── Implied Value Chart ── */
        .value-chart-container {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.5s ease, opacity 0.4s ease, padding 0.5s ease, margin 0.5s ease;
            padding: 0 24px;
            margin-bottom: 0;
        }

        .value-chart-container.visible {
            max-height: 600px;
            opacity: 1;
            padding: 24px;
            margin-bottom: 28px;
        }

        .value-chart-wrapper {
            position: relative;
            height: 400px;
        }

        /* ── Property Context ── */
        .context-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 28px;
        }

        .context-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 24px;
        }

        .context-card h3 {
            font-size: 15px;
            font-weight: 700;
            color: #32373c;
            margin-bottom: 14px;
            padding-bottom: 12px;
            border-bottom: 2px solid #7ebc3b;
        }

        .context-body {
            font-size: 14px;
            color: #4b5563;
            line-height: 1.7;
        }

        .context-body strong {
            color: #32373c;
        }

        .context-highlight {
            background: #f0f9eb;
            border-left: 4px solid #7ebc3b;
            border-radius: 0 8px 8px 0;
            padding: 14px 18px;
            margin-top: 14px;
            font-size: 13px;
            color: #32373c;
            line-height: 1.6;
        }


        /* ── Property Calculator ── */
        .calculator {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 28px;
            margin-bottom: 28px;
        }

        .calculator h3 {
            font-size: 17px;
            font-weight: 700;
            color: #32373c;
            margin-bottom: 6px;
        }

        .calculator .calc-subtitle {
            font-size: 13px;
            color: #6b7280;
            margin-bottom: 24px;
        }

        .calc-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 32px;
            align-items: start;
        }

        .calc-inputs {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .calc-field label {
            display: block;
            font-size: 11px;
            font-weight: 700;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .calc-field .input-wrap {
            position: relative;
        }

        .calc-field .input-wrap .prefix,
        .calc-field .input-wrap .suffix {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            color: #9ca3af;
            pointer-events: none;
        }

        .calc-field .input-wrap .prefix {
            left: 14px;
        }

        .calc-field .input-wrap .suffix {
            right: 14px;
        }

        .calc-field input {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-family: 'Century Gothic', CenturyGothic, Nunito, sans-serif;
            font-size: 15px;
            font-weight: 700;
            color: #32373c;
            background: #f9fafb;
            transition: border-color 0.2s;
        }

        .calc-field input:focus {
            outline: none;
            border-color: #7ebc3b;
            box-shadow: 0 0 0 3px rgba(126, 188, 59, 0.15);
        }

        .calc-field input.has-prefix {
            padding-left: 28px;
        }

        .calc-field input.has-suffix {
            padding-right: 32px;
        }

        .calc-slider {
            margin-top: 4px;
        }

        .calc-slider label {
            display: block;
            font-size: 11px;
            font-weight: 700;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .calc-slider input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e5e7eb;
            outline: none;
            cursor: pointer;
        }

        .calc-slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #7ebc3b;
            border: 2px solid #ffffff;
            box-shadow: 0 1px 4px rgba(0,0,0,0.15);
            cursor: pointer;
        }

        .calc-slider input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #7ebc3b;
            border: 2px solid #ffffff;
            box-shadow: 0 1px 4px rgba(0,0,0,0.15);
            cursor: pointer;
        }

        .calc-slider .slider-value {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-top: 8px;
        }

        .calc-slider .slider-pct {
            font-size: 22px;
            font-weight: 700;
            color: #7ebc3b;
        }

        .calc-slider .slider-desc {
            font-size: 12px;
            color: #9ca3af;
            text-align: right;
        }

        .calc-results {
            min-height: 100%;
        }

        .calc-results-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            color: #9ca3af;
            font-size: 14px;
            text-align: center;
            border: 2px dashed #e5e7eb;
            border-radius: 10px;
            padding: 24px;
        }

        .calc-results-content {
            display: none;
        }

        .calc-results-content.visible {
            display: block;
        }

        .calc-base-val {
            display: flex;
            align-items: center;
            gap: 16px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 18px 22px;
            margin-bottom: 18px;
        }

        .calc-base-val .cbv-value {
            font-size: 28px;
            font-weight: 700;
            color: #32373c;
            white-space: nowrap;
        }

        .calc-base-val .cbv-label {
            font-size: 13px;
            color: #6b7280;
            line-height: 1.4;
        }

        .calc-scenario-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .calc-scenario-table th {
            text-align: left;
            color: #6b7280;
            font-weight: 700;
            padding: 8px 12px;
            border-bottom: 2px solid #e5e7eb;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calc-scenario-table td {
            padding: 9px 12px;
            color: #4b5563;
            border-bottom: 1px solid #f3f4f6;
        }

        .calc-scenario-table tr.scenario-current td {
            color: #32373c;
            font-weight: 700;
            background: #f0f9eb;
        }

        .calc-scenario-table td.val-positive {
            color: #5a9a1f;
            font-weight: 700;
        }

        .calc-scenario-table td.val-negative {
            color: #dc2626;
            font-weight: 700;
        }

        @media (max-width: 900px) {
            .calc-layout {
                grid-template-columns: 1fr;
            }
        }

        /* ── Footer ── */
        .footer {
            text-align: center;
            padding: 24px 40px;
            font-size: 12px;
            color: #9ca3af;
            border-top: 1px solid #e5e7eb;
        }

        .footer a {
            color: #7ebc3b;
            text-decoration: none;
        }

        /* ── Data Note ── */
        .data-note {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 22px 28px;
            margin-bottom: 28px;
            font-size: 13px;
            color: #6b7280;
            line-height: 1.7;
        }

        .data-note h4 {
            font-size: 13px;
            font-weight: 700;
            color: #32373c;
            margin-bottom: 8px;
        }

        .data-note p {
            margin-bottom: 8px;
        }

        .data-note p:last-child {
            margin-bottom: 0;
        }

        /* ── Responsive ── */
        @media (max-width: 900px) {
            .context-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header, .yield-hero, .container {
                padding-left: 20px;
                padding-right: 20px;
            }
            .yield-value {
                font-size: 40px;
            }
            .chart-wrapper, .value-chart-wrapper {
                height: 300px;
            }
            .header-logo img {
                height: 36px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <div class="header-title">
                <h1>UK 30-Year Gilt Yield</h1>
                <p>Benchmark Bond Yield &middot; Live Market Data</p>
            </div>
        </div>
        <div class="header-right">
            <div class="header-meta">
                Last updated: 26 Feb 2026 at 10:32<br>
                Live: 26 Feb 2026 at 10:32 GMT
            </div>
            <div class="header-logo"><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAABAAEDASIAAhEBAxEB/8QAFAABAAAAAAAAAAAAAAAAAAAACf/EABQQAQAAAAAAAAAAAAAAAAAAAAD/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AKwA//9k=" alt="Fairhurst Buckley"></div>
        </div>
    </div>

    <div class="yield-hero">
        <div class="yield-current">
            <span class="yield-value">5.13</span>
            <span class="yield-unit">%</span>
            <span class="yield-time">as at 26 Feb 2026, 10:32 GMT</span>
        </div>
        <div class="yield-change">
            <span class="change-label">Daily Change</span>
            <span class="change-badge negative">-0.01%</span>
        </div>
        <div class="yield-change">
            <span class="change-label">Weekly</span>
            <span class="change-badge negative">-0.07%</span>
        </div>
        <div class="yield-change">
            <span class="change-label">Monthly</span>
            <span class="change-badge negative">-0.17%</span>
        </div>
        <div class="yield-change">
            <span class="change-label">YTD</span>
            <span class="change-badge negative">-0.15%</span>
        </div>
    </div>

    <div class="summary-callout">
        <span class="sc-icon">&#9432;</span>
        Over the past month, gilt yields have <strong>fallen by 0.17%</strong> (17bps),
        reducing the implied cost of long-term property debt.
    </div>

    <div class="container">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">52-Week High</div>
                <div class="stat-value">5.75%</div>
                <div class="stat-sub">03 Sep 2025</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">52-Week Low</div>
                <div class="stat-value">5.04%</div>
                <div class="stat-sub">07 Apr 2025</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">52-Week Range</div>
                <div class="stat-value">0.71%</div>
                <div class="stat-sub">High to Low spread</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Implied Borrowing Cost</div>
                <div class="stat-value">6.88%</div>
                <div class="stat-sub">Gilt + 175bps lending margin</div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <div>
                    <div class="chart-title" id="yieldChartTitle">Yield History &mdash; Last Twelve Months</div>
                    <div class="chart-subtitle">Adjusted to benchmark level (+0.71% spread applied to BoE yield curve)</div>
                </div>
                <div class="timeframe-btns">
                    <button class="tf-btn" data-months="1">1M</button>
                    <button class="tf-btn" data-months="3">3M</button>
                    <button class="tf-btn" data-months="6">6M</button>
                    <button class="tf-btn active" data-months="12">1Y</button>
                </div>
            </div>
            <div class="chart-wrapper">
                <canvas id="yieldChart"></canvas>
            </div>
        </div>

        <div class="trend-summary" id="trendSummary"></div>

        <div class="value-chart-container" id="valueChartContainer">
            <div class="chart-header">
                <div>
                    <div class="chart-title">Implied Disposal Value &mdash; Last 12 Months</div>
                    <div class="chart-subtitle" id="valueChartSubtitle">Enter property details below to see historical implied values</div>
                </div>
            </div>
            <div class="value-chart-wrapper">
                <canvas id="valueChart"></canvas>
            </div>
        </div>

        <div class="calculator">
            <h3>Property Valuation Scenario Tool</h3>
            <p class="calc-subtitle">Enter your property details to see how gilt yield movements could affect the achievable disposal price.</p>
            <div class="calc-layout">
                <div class="calc-inputs">
                    <div class="calc-field">
                        <label>Annual Net Rent</label>
                        <div class="input-wrap">
                            <span class="prefix">&pound;</span>
                            <input type="text" id="calcRent" class="has-prefix" placeholder="e.g. 250,000" inputmode="numeric">
                        </div>
                    </div>
                    <div class="calc-field">
                        <label>Current Property Yield (Cap Rate)</label>
                        <div class="input-wrap">
                            <input type="text" id="calcYield" class="has-suffix" placeholder="e.g. 5.50" inputmode="decimal">
                            <span class="suffix">%</span>
                        </div>
                    </div>
                    <div class="calc-slider">
                        <label>Gilt Pass-Through Rate</label>
                        <input type="range" id="calcPassThrough" min="0" max="100" value="50" step="5">
                        <div class="slider-value">
                            <span class="slider-pct" id="calcPassPct">50%</span>
                            <span class="slider-desc" id="calcPassDesc">50bps gilt move = 25bps yield shift</span>
                        </div>
                        <p style="font-size: 12px; color: #9ca3af; margin-top: 12px; line-height: 1.5;">
                            Property yields don't always move by the same amount as gilts.
                            At 50%, only half of the gilt movement affects the property yield.
                            For example, if gilts rise by 0.50%, the property yield rises by just 0.25%.
                        </p>
                    </div>
                </div>
                <div class="calc-results">
                    <div class="calc-results-placeholder" id="calcPlaceholder">
                        Enter the annual rent and property yield<br>to see valuation scenarios
                    </div>
                    <div class="calc-results-content" id="calcContent">
                        <div class="calc-base-val">
                            <div class="cbv-value" id="calcBaseVal">&mdash;</div>
                            <div class="cbv-label">Current implied<br>disposal value</div>
                        </div>
                        <table class="calc-scenario-table">
                            <thead>
                                <tr>
                                    <th>Gilt Move</th>
                                    <th>Property Yield</th>
                                    <th>Implied Value</th>
                                    <th>Change</th>
                                </tr>
                            </thead>
                            <tbody id="calcTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>


        <div class="data-note">
            <h4>About this data</h4>
            <p>
                The headline yield is the <strong>benchmark 30-year gilt bond yield</strong>
                (4.375% coupon, maturing July 2054)
                &mdash; the same figure quoted by the Financial Times and Bloomberg.
                It is sourced live during UK market hours and updates each time this page is refreshed.
            </p>
            <p>
                The historical chart uses data from the <strong>Bank of England</strong>,
                adjusted to the benchmark yield level so the chart aligns with the headline figure.
                Bank of England data is published with a 2&ndash;3 business day delay;
                the most recent 2&ndash;3 days of the chart therefore reflect the last available BoE reading.
            </p>
        </div>
    </div>

    <div class="footer">
        Live yield: CNBC / Reuters &middot; Historical chart: <a href="https://www.bankofengland.co.uk/statistics/yield-curves" target="_blank">Bank of England</a>
        &middot; Prepared by Fairhurst Buckley
    </div>

    <script>
        const dates = ["2025-02-25", "2025-02-26", "2025-02-27", "2025-02-28", "2025-03-03", "2025-03-04", "2025-03-05", "2025-03-06", "2025-03-07", "2025-03-10", "2025-03-11", "2025-03-12", "2025-03-13", "2025-03-14", "2025-03-17", "2025-03-18", "2025-03-19", "2025-03-20", "2025-03-21", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-03", "2025-04-04", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-01", "2025-05-02", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-27", "2025-05-28", "2025-05-29", "2025-05-30", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-16", "2025-06-17", "2025-06-18", "2025-06-19", "2025-06-20", "2025-06-23", "2025-06-24", "2025-06-25", "2025-06-26", "2025-06-27", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-15", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-26", "2025-08-27", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-02", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-22", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04", "2025-11-05", "2025-11-06", "2025-11-07", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14", "2025-11-17", "2025-11-18", "2025-11-19", "2025-11-20", "2025-11-21", "2025-11-24", "2025-11-25", "2025-11-26", "2025-11-27", "2025-11-28", "2025-12-01", "2025-12-02", "2025-12-03", "2025-12-04", "2025-12-05", "2025-12-08", "2025-12-09", "2025-12-10", "2025-12-11", "2025-12-12", "2025-12-15", "2025-12-16", "2025-12-17", "2025-12-18", "2025-12-19", "2025-12-22", "2025-12-23", "2025-12-24", "2025-12-29", "2025-12-30", "2025-12-31", "2026-01-02", "2026-01-05", "2026-01-06", "2026-01-07", "2026-01-08", "2026-01-09", "2026-01-12", "2026-01-13", "2026-01-14", "2026-01-15", "2026-01-16", "2026-01-19", "2026-01-20", "2026-01-21", "2026-01-22", "2026-01-23", "2026-01-26", "2026-01-27", "2026-01-28", "2026-01-29", "2026-01-30", "2026-02-02", "2026-02-03", "2026-02-04", "2026-02-05", "2026-02-06", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-16", "2026-02-17", "2026-02-18", "2026-02-19", "2026-02-20", "2026-02-23", "2026-02-24"];
        const yields = [5.2141, 5.2254, 5.2396, 5.1892, 5.252, 5.1878, 5.3678, 5.3901, 5.3306, 5.3107, 5.3507, 5.4075, 5.3702, 5.3482, 5.3084, 5.3236, 5.318, 5.3379, 5.3817, 5.4082, 5.4351, 5.4079, 5.4756, 5.3937, 5.3668, 5.327, 5.3187, 5.2061, 5.1536, 5.3046, 5.3063, 5.4472, 5.3436, 5.4499, 5.3606, 5.3478, 5.3115, 5.2674, 5.2644, 5.2651, 5.2037, 5.1965, 5.2083, 5.1859, 5.1586, 5.1606, 5.1943, 5.2271, 5.1654, 5.2285, 5.2672, 5.3412, 5.3593, 5.4219, 5.3772, 5.3528, 5.3707, 5.4122, 5.468, 5.4801, 5.4231, 5.3976, 5.4332, 5.3718, 5.3769, 5.369, 5.3331, 5.3345, 5.3367, 5.3527, 5.354, 5.2648, 5.2731, 5.2023, 5.2653, 5.2475, 5.2554, 5.216, 5.2479, 5.2532, 5.2072, 5.1705, 5.2014, 5.1921, 5.2286, 5.2196, 5.1636, 5.3179, 5.2738, 5.2799, 5.3063, 5.361, 5.3349, 5.3296, 5.3596, 5.3408, 5.3734, 5.3785, 5.3852, 5.4224, 5.3493, 5.3108, 5.3555, 5.3728, 5.3826, 5.3873, 5.3543, 5.3364, 5.308, 5.2784, 5.2515, 5.2432, 5.2523, 5.2797, 5.3298, 5.2983, 5.3412, 5.3209, 5.3724, 5.4233, 5.4805, 5.4736, 5.416, 5.4737, 5.4328, 5.4881, 5.4715, 5.4519, 5.4745, 5.5057, 5.5584, 5.5069, 5.4883, 5.4037, 5.3663, 5.3859, 5.3921, 5.362, 5.4106, 5.3862, 5.396, 5.3743, 5.4218, 5.4729, 5.4595, 5.449, 5.4371, 5.5061, 5.5075, 5.4645, 5.4685, 5.4616, 5.4754, 5.4592, 5.4908, 5.5003, 5.4754, 5.5143, 5.4383, 5.4299, 5.3523, 5.3021, 5.279, 5.302, 5.2789, 5.249, 5.1856, 5.1849, 5.1967, 5.1733, 5.1675, 5.1652, 5.1771, 5.183, 5.213, 5.1792, 5.2369, 5.2082, 5.2308, 5.2268, 5.1575, 5.1799, 5.2111, 5.3426, 5.3166, 5.3245, 5.3893, 5.365, 5.3198, 5.3298, 5.2762, 5.2166, 5.2468, 5.2392, 5.271, 5.2744, 5.2285, 5.2218, 5.2628, 5.3285, 5.2967, 5.3005, 5.2625, 5.3061, 5.2772, 5.3051, 5.2584, 5.265, 5.308, 5.3298, 5.2996, 5.3053, 5.2808, 5.2895, 5.2773, 5.3322, 5.309, 5.2868, 5.2161, 5.2127, 5.1754, 5.1707, 5.1896, 5.1539, 5.1791, 5.2061, 5.2075, 5.2627, 5.2495, 5.2827, 5.2978, 5.2942, 5.3235, 5.3434, 5.3119, 5.3331, 5.3197, 5.3235, 5.3478, 5.3631, 5.3438, 5.3537, 5.3176, 5.3048, 5.2677, 5.2279, 5.2202, 5.195, 5.1948, 5.1942, 5.173, 5.1343, 5.129];

        // Compute 30-day Simple Moving Average
        function computeSMA(data, window) {
            const sma = [];
            for (let i = 0; i < data.length; i++) {
                if (i < window - 1) {
                    sma.push(null);
                } else {
                    let sum = 0;
                    for (let j = i - window + 1; j <= i; j++) {
                        sum += data[j];
                    }
                    sma.push(sum / window);
                }
            }
            return sma;
        }
        const yieldSMA30 = computeSMA(yields, 30);

        const ctx = document.getElementById('yieldChart').getContext('2d');

        // Gradient fill using Fairhurst Buckley green
        const gradient = ctx.createLinearGradient(0, 0, 0, 450);
        gradient.addColorStop(0, 'rgba(126, 188, 59, 0.18)');
        gradient.addColorStop(1, 'rgba(126, 188, 59, 0.0)');

        const yieldChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: dates,
                datasets: [{
                    label: '30-Year Gilt Yield (%)',
                    data: yields,
                    borderColor: '#7ebc3b',
                    backgroundColor: gradient,
                    borderWidth: 2.5,
                    fill: true,
                    tension: 0.15,
                    pointRadius: 0,
                    pointHoverRadius: 6,
                    pointHoverBackgroundColor: '#7ebc3b',
                    pointHoverBorderColor: '#ffffff',
                    pointHoverBorderWidth: 2,
                }, {
                    label: '30-Day Moving Average (%)',
                    data: yieldSMA30,
                    borderColor: 'rgba(126, 188, 59, 0.5)',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    borderDash: [6, 4],
                    fill: false,
                    tension: 0.15,
                    pointRadius: 0,
                    pointHoverRadius: 4,
                    pointHoverBackgroundColor: 'rgba(126, 188, 59, 0.5)',
                    pointHoverBorderColor: '#ffffff',
                    pointHoverBorderWidth: 2,
                    spanGaps: false,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    intersect: false,
                    mode: 'index',
                },
                plugins: {
                    legend: {
                        display: false,
                    },
                    tooltip: {
                        backgroundColor: '#32373c',
                        titleColor: '#ffffff',
                        bodyColor: '#e5e7eb',
                        borderColor: '#7ebc3b',
                        borderWidth: 1,
                        padding: 12,
                        cornerRadius: 8,
                        displayColors: true,
                        titleFont: { family: "'Century Gothic', CenturyGothic, Nunito, sans-serif", weight: '700' },
                        bodyFont: { family: "'Century Gothic', CenturyGothic, Nunito, sans-serif" },
                        callbacks: {
                            title: function(items) {
                                const dateStr = dates[items[0].dataIndex];
                                const parts = dateStr.split('-');
                                const d = new Date(parts[0], parts[1] - 1, parts[2]);
                                return d.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
                            },
                            label: function(item) {
                                if (item.parsed.y === null || item.parsed.y === undefined) return null;
                                if (item.datasetIndex === 0) {
                                    return 'Yield: ' + item.parsed.y.toFixed(4) + '%';
                                } else {
                                    return '30d MA: ' + item.parsed.y.toFixed(4) + '%';
                                }
                            },
                            filter: function(item) {
                                return item.parsed.y !== null && item.parsed.y !== undefined;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        type: 'time',
                        time: {
                            unit: 'month',
                            displayFormats: {
                                month: 'MMM yyyy'
                            }
                        },
                        grid: {
                            color: '#f3f4f6',
                        },
                        ticks: {
                            color: '#6b7280',
                            font: { size: 11, family: "'Century Gothic', CenturyGothic, Nunito, sans-serif" },
                            maxRotation: 0,
                        },
                        border: {
                            color: '#e5e7eb',
                        }
                    },
                    y: {
                        grid: {
                            color: '#f3f4f6',
                        },
                        ticks: {
                            color: '#6b7280',
                            font: { size: 11, family: "'Century Gothic', CenturyGothic, Nunito, sans-serif" },
                            callback: function(value) {
                                return value.toFixed(2) + '%';
                            }
                        },
                        border: {
                            color: '#e5e7eb',
                        }
                    }
                }
            }
        });

        // Populate trend summary
        (function() {
            const lastYield = yields[yields.length - 1];
            const lastSMA = yieldSMA30[yieldSMA30.length - 1];
            const el = document.getElementById('trendSummary');

            if (lastSMA === null || lastSMA === undefined) {
                el.style.display = 'none';
                return;
            }

            const diff = lastYield - lastSMA;
            const diffBps = Math.abs(diff * 100).toFixed(0);
            const falling = diff < 0;

            const icon = falling ? '&#9660;' : '&#9650;';
            const dirClass = falling ? 'trend-favourable' : 'trend-adverse';
            const dirWord = falling ? 'falling' : 'rising';
            const commentary = falling
                ? 'favourable conditions for property values'
                : 'headwind for property values';

            el.innerHTML =
                '<span class="trend-icon ' + dirClass + '">' + icon + '</span>' +
                '<span>30-day trend: Yields <span class="trend-direction ' + dirClass + '">' + dirWord + '</span> ' +
                '&mdash; current yield is <span class="trend-bps">' + diffBps + 'bps</span> ' +
                (falling ? 'below' : 'above') + ' the 30-day moving average. ' +
                '<em>' + commentary + '.</em></span>';
        })();

        // Time frame selector
        document.querySelectorAll('.tf-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.tf-btn').forEach(function(b) { b.classList.remove('active'); });
                this.classList.add('active');
                const months = parseInt(this.dataset.months);
                const cutoff = new Date();
                cutoff.setMonth(cutoff.getMonth() - months);
                const minDate = cutoff.toISOString().split('T')[0];

                yieldChart.options.scales.x.min = minDate;
                yieldChart.update();

                if (typeof valueChartInstance !== 'undefined' && valueChartInstance) {
                    valueChartInstance.options.scales.x.min = minDate;
                    valueChartInstance.update();
                }

                const titles = {1:'Last Month', 3:'Last 3 Months', 6:'Last 6 Months', 12:'Last Twelve Months'};
                document.getElementById('yieldChartTitle').textContent = 'Yield History — ' + titles[months];
            });
        });
    </script>

    <script>
        // ── Property Valuation Calculator ──
        const CURRENT_GILT = 5.129;
        const rentInput = document.getElementById('calcRent');
        const yieldInput = document.getElementById('calcYield');
        const passThroughInput = document.getElementById('calcPassThrough');
        const passPctEl = document.getElementById('calcPassPct');
        const passDescEl = document.getElementById('calcPassDesc');
        const placeholder = document.getElementById('calcPlaceholder');
        const content = document.getElementById('calcContent');
        const baseValEl = document.getElementById('calcBaseVal');
        const tableBody = document.getElementById('calcTableBody');

        function parseNumber(str) {
            return parseFloat(str.replace(/[^0-9.]/g, ''));
        }

        function formatGBP(val) {
            if (val >= 1e6) {
                return '\u00A3' + (val / 1e6).toFixed(2) + 'm';
            }
            return '\u00A3' + val.toLocaleString('en-GB', { maximumFractionDigits: 0 });
        }

        function formatGBPFull(val) {
            return '\u00A3' + val.toLocaleString('en-GB', { maximumFractionDigits: 0 });
        }

        // ── Implied Value Chart ──
        let valueChartInstance = null;
        const valueChartContainer = document.getElementById('valueChartContainer');
        const valueChartSubtitle = document.getElementById('valueChartSubtitle');

        function updateValueChart(rent, propYield, passThrough) {
            if (!rent || !propYield || rent <= 0 || propYield <= 0) {
                valueChartContainer.classList.remove('visible');
                return;
            }

            // Compute implied values for each historical data point
            const impliedValues = [];
            for (let i = 0; i < yields.length; i++) {
                const giltDelta = yields[i] - CURRENT_GILT;
                const adjustedYield = propYield + (giltDelta * passThrough);
                if (adjustedYield <= 0) {
                    impliedValues.push(null);
                } else {
                    impliedValues.push(rent / (adjustedYield / 100));
                }
            }

            // Compute 30-day SMA of implied values
            const valueSMA30 = [];
            for (let i = 0; i < impliedValues.length; i++) {
                if (i < 29) {
                    valueSMA30.push(null);
                } else {
                    let sum = 0;
                    let count = 0;
                    for (let j = i - 29; j <= i; j++) {
                        if (impliedValues[j] !== null) {
                            sum += impliedValues[j];
                            count++;
                        }
                    }
                    valueSMA30.push(count > 0 ? sum / count : null);
                }
            }

            // Update subtitle
            const rentDisplay = '\u00A3' + rent.toLocaleString('en-GB', { maximumFractionDigits: 0 });
            const ptPct = Math.round(passThrough * 100);
            valueChartSubtitle.textContent =
                'Based on ' + rentDisplay + ' rent at ' + propYield.toFixed(2) + '% yield with ' + ptPct + '% gilt pass-through';

            valueChartContainer.classList.add('visible');

            if (valueChartInstance) {
                valueChartInstance.data.datasets[0].data = impliedValues;
                valueChartInstance.data.datasets[1].data = valueSMA30;
                const todayVal = impliedValues[impliedValues.length - 1];
                valueChartInstance.data.datasets[2].data =
                    new Array(impliedValues.length - 1).fill(null).concat([todayVal]);
                valueChartInstance.update('none');
            } else {
                const vCtx = document.getElementById('valueChart').getContext('2d');
                const vGradient = vCtx.createLinearGradient(0, 0, 0, 400);
                vGradient.addColorStop(0, 'rgba(212, 160, 57, 0.18)');
                vGradient.addColorStop(1, 'rgba(212, 160, 57, 0.0)');

                const todayVal = impliedValues[impliedValues.length - 1];
                const todayData = new Array(impliedValues.length - 1).fill(null).concat([todayVal]);

                valueChartInstance = new Chart(vCtx, {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [
                            {
                                label: 'Implied Disposal Value',
                                data: impliedValues,
                                borderColor: '#d4a039',
                                backgroundColor: vGradient,
                                borderWidth: 2.5,
                                fill: true,
                                tension: 0.15,
                                pointRadius: 0,
                                pointHoverRadius: 6,
                                pointHoverBackgroundColor: '#d4a039',
                                pointHoverBorderColor: '#ffffff',
                                pointHoverBorderWidth: 2,
                                spanGaps: true,
                            },
                            {
                                label: '30-Day Moving Average',
                                data: valueSMA30,
                                borderColor: 'rgba(212, 160, 57, 0.5)',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                borderDash: [6, 4],
                                fill: false,
                                tension: 0.15,
                                pointRadius: 0,
                                pointHoverRadius: 4,
                                pointHoverBackgroundColor: 'rgba(212, 160, 57, 0.5)',
                                pointHoverBorderColor: '#ffffff',
                                pointHoverBorderWidth: 2,
                                spanGaps: false,
                            },
                            {
                                label: "Today's Value",
                                data: todayData,
                                borderColor: '#d4a039',
                                backgroundColor: '#d4a039',
                                pointRadius: 8,
                                pointHoverRadius: 10,
                                pointStyle: 'circle',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 3,
                                showLine: false,
                                fill: false,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index',
                        },
                        plugins: {
                            legend: {
                                display: false,
                            },
                            tooltip: {
                                backgroundColor: '#32373c',
                                titleColor: '#ffffff',
                                bodyColor: '#e5e7eb',
                                borderColor: '#d4a039',
                                borderWidth: 1,
                                padding: 12,
                                cornerRadius: 8,
                                displayColors: true,
                                titleFont: { family: "'Century Gothic', CenturyGothic, Nunito, sans-serif", weight: '700' },
                                bodyFont: { family: "'Century Gothic', CenturyGothic, Nunito, sans-serif" },
                                callbacks: {
                                    title: function(items) {
                                        const dateStr = dates[items[0].dataIndex];
                                        const parts = dateStr.split('-');
                                        const d = new Date(parts[0], parts[1] - 1, parts[2]);
                                        return d.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
                                    },
                                    label: function(item) {
                                        if (item.parsed.y === null || item.parsed.y === undefined) return null;
                                        const val = item.parsed.y;
                                        let lbl = item.dataset.label + ': ';
                                        if (val >= 1e6) {
                                            lbl += '\u00A3' + (val / 1e6).toFixed(2) + 'm';
                                        } else {
                                            lbl += '\u00A3' + val.toLocaleString('en-GB', { maximumFractionDigits: 0 });
                                        }
                                        return lbl;
                                    },
                                    filter: function(item) {
                                        return item.parsed.y !== null && item.parsed.y !== undefined;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                type: 'time',
                                time: {
                                    unit: 'month',
                                    displayFormats: {
                                        month: 'MMM yyyy'
                                    }
                                },
                                grid: { color: '#f3f4f6' },
                                ticks: {
                                    color: '#6b7280',
                                    font: { size: 11, family: "'Century Gothic', CenturyGothic, Nunito, sans-serif" },
                                    maxRotation: 0,
                                },
                                border: { color: '#e5e7eb' }
                            },
                            y: {
                                grid: { color: '#f3f4f6' },
                                ticks: {
                                    color: '#6b7280',
                                    font: { size: 11, family: "'Century Gothic', CenturyGothic, Nunito, sans-serif" },
                                    callback: function(value) {
                                        if (value >= 1e6) {
                                            return '\u00A3' + (value / 1e6).toFixed(1) + 'm';
                                        }
                                        return '\u00A3' + (value / 1e3).toFixed(0) + 'k';
                                    }
                                },
                                border: { color: '#e5e7eb' }
                            }
                        }
                    }
                });
            }
        }

        function updateSliderLabel() {
            const pt = parseInt(passThroughInput.value);
            passPctEl.textContent = pt + '%';
            const exampleShift = Math.round(50 * pt / 100);
            passDescEl.textContent = '50bps gilt move = ' + exampleShift + 'bps yield shift';
        }

        function recalculate() {
            updateSliderLabel();

            const rent = parseNumber(rentInput.value);
            const propYield = parseNumber(yieldInput.value);
            const passThrough = parseInt(passThroughInput.value) / 100;

            if (!rent || !propYield || rent <= 0 || propYield <= 0) {
                placeholder.style.display = 'flex';
                content.classList.remove('visible');
                updateValueChart(0, 0, 0);
                return;
            }

            placeholder.style.display = 'none';
            content.classList.add('visible');

            const baseValue = rent / (propYield / 100);
            baseValEl.textContent = formatGBP(baseValue);

            // Scenarios: gilt moves from -75bps to +75bps in 25bp steps
            // Property yield shift = gilt move * pass-through rate
            const scenarios = [-75, -50, -25, 0, 25, 50, 75];
            let html = '';

            scenarios.forEach(function(deltaBps) {
                const effectiveShift = deltaBps * passThrough;
                const newPropYield = propYield + (effectiveShift / 100);
                if (newPropYield <= 0) return;

                const newValue = rent / (newPropYield / 100);
                const change = newValue - baseValue;
                const changePct = (change / baseValue) * 100;
                const isCurrent = deltaBps === 0;

                const rowClass = isCurrent ? ' class="scenario-current"' : '';
                const label = isCurrent ? 'Current' : (deltaBps > 0 ? '+' : '') + deltaBps + 'bps';

                let changeCell;
                if (isCurrent) {
                    changeCell = '<td>&mdash;</td>';
                } else if (change > 0) {
                    changeCell = '<td class="val-positive">+' + formatGBPFull(Math.round(change)) + ' (+' + changePct.toFixed(1) + '%)</td>';
                } else {
                    changeCell = '<td class="val-negative">' + formatGBPFull(Math.round(change)) + ' (' + changePct.toFixed(1) + '%)</td>';
                }

                html += '<tr' + rowClass + '>' +
                    '<td>' + label + '</td>' +
                    '<td>' + newPropYield.toFixed(2) + '%</td>' +
                    '<td>' + formatGBP(newValue) + '</td>' +
                    changeCell +
                    '</tr>';
            });

            tableBody.innerHTML = html;

            // Update implied value chart
            updateValueChart(rent, propYield, passThrough);
        }

        // Format rent input with commas as user types
        rentInput.addEventListener('input', function() {
            const raw = this.value.replace(/[^0-9]/g, '');
            if (raw) {
                this.value = parseInt(raw).toLocaleString('en-GB');
            }
            recalculate();
        });

        yieldInput.addEventListener('input', recalculate);
        passThroughInput.addEventListener('input', recalculate);
    </script>
</body>
</html>